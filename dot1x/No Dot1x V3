#Int Modules
import os
import re
from ciscoconfparse import CiscoConfParse
from netmiko import ConnectHandler

#Loop through Directory to find switchports with 802.1x
root = "/home/jbowers/Nodot1x/Configs"
for file in os.listdir(root):
    if not file.startswith("P"):
        continue
    config_path = os.path.join(root, file)
    parse = CiscoConfParse(config_path)
    all_intfs = parse.find_objects(r"^interf")
    NoDot1x = list()
    NoDot1x = parse.find_objects_wo_child(r'^interface', r'authentication')

    #Remove Non Gig Ports
    GigPorts = [x.text.split()[1] for x in NoDot1x if x.text.startswith("interface Gig")]

    #Further Filter
    final_list= [w for w in GigPorts if not re.match(r'GigabitEthernet./1/.', w)]

    #Netmiko Gets Port Descriptions
    port = final_list
    cmd = "show run int "port" | i desc"  
    print (cmd)
    net_connect = ConnectHandler(device_type='cisco_ios', host=file, username='zjabn3tw', pas$
    desc = net_connect.send_command(cmd)
    print desc

    #Display Filtered Results
    print(config_path)
    for item in final_list: print(item)
